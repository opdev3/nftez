var LT;(()=>{"use strict";const e="ghostnet",t="KT1TRuN4Uc4ai6ZjWRjtedX9ChmfcfvxfBXt",n="-1835576114,-1889653220,-1513923773";function a(e){return Array.from((new TextEncoder).encode(e),(e=>e.toString(16).padStart(2,"0"))).join("")}function s(e){const t=new Uint8Array(e.length/2);for(let n=0;n!==t.length;n++)t[n]=parseInt(e.substr(2*n,2),16);return(new TextDecoder).decode(t)}function o(e){return e&&e.length>14?e.substring(0,5)+"..."+e.substring(e.length-5):e}function i(e){if(navigator.clipboard)return navigator.clipboard.writeText(e).then((function(){}),(function(e){return console.log("ERROR copyToClipboard(): "+e),!1})),!0;let t;var n=document.createElement("textarea");n.value=e,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),t=!0}catch(e){console.log("ERROR copyToClipboard(): "+e)}return document.body.removeChild(n),t}function r(e){return/^(tz|KT)[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]{34}$/.test(String(e))}function c(){try{return(new Error).stack.split("\n")[2].replace(/^\s+at\s+(.+?)\s.+/g,"$1")}catch(e){return""}}let l="";const d=new beacon.DAppClient({name:"NFTez",network:{type:e,rpcUrl:"https://rpc.tzkt.io/"+e}});async function m(t,a,s){let o="sort.desc=lastActivity&select=address,tokensCount,firstActivityTime,creator.address as creator&typeHash"+(n.indexOf(",")>=0?".in":"")+"="+n+(a?"&limit="+a:"")+(s?"&offset="+s:"")+(t?"&creator="+t:"");try{let t=await fetch("https://api."+e+".tzkt.io/v1/contracts?"+o);if(t.ok)return await t.json();console.log("ERROR "+c()+"(): can't get collections")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}async function u(t){try{let n=await fetch("https://api."+e+".tzkt.io/v1/contracts/"+t+"/bigmaps/metadata/keys?key=content&select=value");if(n.ok)return(await n.json())[0];console.log("ERROR "+c()+"(): can't get collection metadata")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}async function g(n,a){let s="sort.desc=id&active=true&select=key,value"+(n?"&value.token.address="+n:"")+(a?"&value.token.id="+a:"");try{let n=await fetch("https://api."+e+".tzkt.io/v1/contracts/"+t+"/bigmaps/offers/keys?"+s);if(n.ok){let e=await n.json();if(e&&e.length>0){let t=null;for(let n of e)n.value.seller!==l&&(t?Number(t.value.price)>=Number(n.value.price)&&(t=n):t=n);return t}}else console.log("ERROR "+c()+"(): can't get best offer")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}async function y(t,n){let a="limit=1&select=account.address as account,token,balance,firstTime&token.contract="+t+"&token.tokenid="+n;try{let t=await fetch("https://api."+e+".tzkt.io/v1/tokens/balances?"+a+"&account="+l);if(t.ok){let n=await t.json();if(n.length>0)return n[0];{let t=await fetch("https://api."+e+".tzkt.io/v1/tokens/balances?"+a);if(t.ok){if(n=await t.json(),n.length>0)return n[0].account=l,n[0].balance=0,n[0]}else console.log("ERROR "+c()+"(): can't get token")}}else console.log("ERROR "+c()+"(): can't get token balance")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}const f={message:"The address is copied",type:"is-success"};async function p(){document.getElementById("btnMoreActiveTokens").classList.add("is-loading");let t=document.getElementById("dActiveTokens"),n=0,a=await async function(t,n){let a="sort.desc=lastActivity&select=contract,tokenId,totalSupply,metadata&totalSupply.gt=0&metadata.artifactUri.as=data*&limit=20"+(n?"&offset="+n:"");try{let t=await fetch("https://api."+e+".tzkt.io/v1/tokens?"+a);if(t.ok)return await t.json();console.log("ERROR "+c()+"(): can't get tokens")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}(0,T);for(let e of a){n++;let a=e.token?e.token:e,s=await k(a);t.append(s)}let s=document.getElementById("dMoreActiveTokens");n<20?s.classList.add("is-hidden"):s.classList.remove("is-hidden"),document.getElementById("btnMoreActiveTokens").classList.remove("is-loading"),0===(T+=n)&&(t.textContent="There are no tokens yet.")}bulmaToast.setDefaults({duration:5e3,position:"bottom-left",animate:{in:"zoomIn",out:"zoomOut"}}),document.addEventListener("DOMContentLoaded",(async function(){document.getElementById("iconMainnetActive").classList.add("is-hidden"),document.getElementById("iconMainnetNotActive").classList.remove("is-hidden"),document.getElementById("iconTestnetNotActive").classList.add("is-hidden"),document.getElementById("iconTestnetActive").classList.remove("is-hidden"),await j(!0);let e=new URLSearchParams(window.location.search).get("cmd");"info"===e?await(document.getElementById("btnBurger").classList.remove("is-active"),document.getElementById("navbarMenu").classList.remove("is-active"),N(),void document.getElementById("pageInfo").classList.remove("is-hidden")):"tokens"===e?await async function(){N(),document.getElementById("dTokens").innerHTML="",document.getElementById("pageTokens").classList.remove("is-hidden");let e=new URLSearchParams(window.location.search).get("cid");e&&(E=e),await b()}():"token"===e?await async function(){N();let e=document.getElementById("btnTokenBuy"),t=document.getElementById("btnTokenList");t.classList.add("is-hidden");let n=document.getElementById("btnTokenBurn");n.classList.add("is-hidden");let a=document.getElementById("btnTokenTransfer");a.classList.add("is-hidden"),document.getElementById("dToken").classList.add("is-hidden"),document.getElementById("pageToken").classList.remove("is-hidden");let s=new URL(window.location),r=new URLSearchParams(window.location.search),c=r.get("cid");c?E=c:c=E;let d=r.get("tid");d?B=d:d=B;let m,u=document.getElementById("pageToken"),p=await y(E,d);if(p){let r;w=p,p.account===l&&p.balance>0&&(t.classList.remove("is-hidden"),n.classList.remove("is-hidden"),a.classList.remove("is-hidden")),new Promise((t=>{setTimeout((()=>{t(Promise.all([g(p.token.contract.address,p.token.tokenId),e]))}),10)})).then((e=>{e[0]&&(e[1].append(document.createTextNode((parseFloat(e[0].value.price)/1e6).toFixed(2)+" êœ©")),e[1].addEventListener("click",(()=>S(e[0].key,e[0].value.price))),e[1].removeAttribute("disabled"))})),m=p.token.metadata?.name,u.querySelector(".js-name").innerText=m||"",m=p.token.metadata?.description,u.querySelector(".js-description").innerText=m||"";let c=u.querySelector(".js-creators"),d=u.querySelector(".js-creator");m=p.token.metadata?.creators;try{m=JSON.parse(m);for(let e=0;e<m.length;e++)r=d.cloneNode(!0),r.setAttribute("href",s.origin+s.pathname+"?cmd=tokens&creator="+m[e]),r.append(document.createTextNode(o(m[e]))),r.classList.remove("is-hidden"),c.append(r),c.append(document.createElement("br"))}catch(e){u.querySelector(".js-creators").innerText=""}m=l&&l===p.account?p.balance:"",u.querySelector(".js-balance").innerText=m||"",m=p.token.totalSupply,u.querySelector(".js-editions").innerText=m||"",m=p.firstTime,u.querySelector(".js-firsttime").innerText=m?new Date(Date.parse(m)).toLocaleString():"";let y=p.token.contract.address;r=u.querySelector(".js-contract"),r.setAttribute("href",s.origin+s.pathname+"?cmd=tokens&cid="+y),r.append(document.createTextNode(o(y))),u.querySelector(".js-contract-copy").addEventListener("click",(()=>{y&&i(y)&&bulmaToast.toast(f)})),m=p.token.tokenId,u.querySelector(".js-tokenid").innerText=m||"";let v=u.querySelector(".tags"),h=v.querySelector(".tag");m=p.token.metadata?.tags;try{m=JSON.parse(m);for(let e=0;e<m.length;e++)r=h.cloneNode(!0),r.append(document.createTextNode(m[e])),r.setAttribute("href",s.origin+s.pathname+"?cmd=tokens&tag="+m[e]),r.classList.remove("is-hidden"),v.append(r)}catch(e){v.innerText=""}let T=p.token.metadata?.mimeType;if(u.querySelector(".js-type").innerText=T||"",m=p.token.metadata?.artifactUri,m){try{new URL(m),m=m.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}T&&T.startsWith("video")?(u.querySelector(".js-img").remove(),u.querySelector(".js-audio").remove(),u.querySelector(".js-svg").remove(),r=u.querySelector(".js-video"),r.setAttribute("src",m)):T&&T.startsWith("audio")?(u.querySelector(".js-img").remove(),u.querySelector(".js-video").remove(),u.querySelector(".js-svg").remove(),r=u.querySelector(".js-audio"),r.setAttribute("src",m)):T&&T.startsWith("image/svg+xml")?(u.querySelector(".js-img").remove(),u.querySelector(".js-video").remove(),u.querySelector(".js-audio").remove(),r=u.querySelector(".js-svg"),r.setAttribute("data",m)):(u.querySelector(".js-video").remove(),u.querySelector(".js-audio").remove(),u.querySelector(".js-svg").remove(),r=u.querySelector(".js-img"),r.setAttribute("src",m)),r.classList.remove("is-hidden")}document.getElementById("dToken").classList.remove("is-hidden")}}():"search"===e?await async function(){N(),document.getElementById("pageSearch").classList.remove("is-hidden")}():"collections"===e?await async function(){N(),document.getElementById("dCollections").innerHTML="",document.getElementById("pageCollections").classList.remove("is-hidden"),await h()}():"newtoken"===e?await async function(){if(N(),l?document.getElementById("btnNewTokenCreate").removeAttribute("disabled"):(document.getElementById("btnNewTokenCreate").setAttribute("disabled",""),bulmaToast.toast({message:"To create a new token you need to connect wallet.",type:"is-danger"})),document.getElementById("nftCreators").value=l,document.getElementById("pageNewToken").classList.remove("is-hidden"),l){const e=document.getElementById("nftCollection");let t=document.createElement("option");t.setAttribute("value","KT1VCnPM6SKpvza6TLkbNcoxAgS6B61JLGtE"),t.append(document.createTextNode("ZeroTerminal default")),e.append(t),e.parentNode.classList.add("is-loading");let n=await m(l,15,v);if(n)for(let a of n){let n=await u(a.address);if(n)try{n=JSON.parse(s(n))}catch(e){continue}t=document.createElement("option"),t.setAttribute("value",a.address),t.append(document.createTextNode(n?.name)),e.append(t)}e.parentNode.classList.remove("is-loading")}}():"newcollection"===e?await async function(){N(),l?document.getElementById("btnNewCollectionCreate").removeAttribute("disabled"):(document.getElementById("btnNewCollectionCreate").setAttribute("disabled",""),bulmaToast.toast({message:"To create a new collection you need to connect wallet.",type:"is-danger"})),document.getElementById("cCreators").value=l,document.getElementById("pageNewCollection").classList.remove("is-hidden")}():"listings"===e?await async function(){N(),document.getElementById("dListings").innerHTML="",document.getElementById("pageListings").classList.remove("is-hidden"),await I()}():await async function(){N(),document.getElementById("dActiveTokens").innerHTML="",document.getElementById("pageActiveTokens").classList.remove("is-hidden"),await p()}()})),document.getElementById("dMoreActiveTokens").addEventListener("click",(()=>p())),document.getElementById("btnMoreCollections").addEventListener("click",(()=>h()));var v=0;async function h(){document.getElementById("btnMoreCollections").classList.add("is-loading");let e=document.getElementById("dCollections"),t=0,n=new URLSearchParams(window.location.search).get("creator"),a=await m(n,15,v);if(a)for(let n of a){t++;let a=await u(n.address);if(a)try{a=JSON.parse(s(a))}catch(e){continue}const r=document.getElementById("t-collection").content.cloneNode(!0);let c=a?.imageUri;if(c){try{new URL(c),c=c.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}r.querySelector(".js-img").setAttribute("src",c)}r.querySelector(".js-name").innerText=a?.name,r.querySelector(".js-description").innerText=a?.description,r.querySelector(".js-address").prepend(document.createTextNode(o(n.address))),r.querySelector(".copy-item").addEventListener("click",(()=>{n.address&&i(n.address)&&bulmaToast.toast(f)})),r.querySelector(".js-count").innerText=n.tokensCount;let l=new URL(window.location);r.querySelectorAll(".js-collection-item").forEach((function(e){e.setAttribute("href",l.origin+l.pathname+"?cmd=tokens&cid="+n.address)})),e.append(r)}let r=document.getElementById("dMoreCollections");t<15?r.classList.add("is-hidden"):r.classList.remove("is-hidden"),document.getElementById("btnMoreCollections").classList.remove("is-loading"),0===(v+=t)&&(e.textContent="There are no collections yet.")}document.getElementById("btnMoreTokens").addEventListener("click",(()=>b()));var T=0,E="";async function b(){document.getElementById("btnMoreTokens").classList.add("is-loading");let t,n=document.getElementById("dTokens"),a=0,s=new URLSearchParams(window.location.search);t=s.get("account")?await async function(t,n,a){let s="sort.desc=id&select=account.address%20as%20account,token,balance&balance.gt=0&token.standard=fa2"+(t?"&account="+t:"")+"&limit=20"+(a?"&offset="+a:"")+"&token.metadata.artifactUri.as=data:*";try{let t=await fetch("https://api."+e+".tzkt.io/v1/tokens/balances?"+s);if(t.ok)return await t.json();console.log("ERROR "+c()+"(): can't get tokens")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}(s.get("account"),0,T):await async function(t,n,a,s,o,i,r,l){let d="sort.desc=id&select=contract,tokenId,totalSupply,metadata&totalSupply.gt=0&limit=20"+(n?"&offset="+n:"")+(a?"&contract.in="+a:"")+(l?"&firstMinter="+l:"")+(s?"&metadata.name="+s:"")+"&metadata.artifactUri.as=data:"+(r||"")+"*";if(o&&o.length>0){o.sort(),d+="&metadata.creators.as=*";for(let e of o)d+='"'+e+'"*'}if(i&&i.length>0){i.sort(((e,t)=>e.localeCompare(t))),d+="&metadata.tags.as=*";for(let e of i)d+='"'+e+'"*'}try{let t=await fetch("https://api."+e+".tzkt.io/v1/tokens?"+d);if(t.ok)return await t.json();console.log("ERROR "+c()+"(): can't get tokens")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}(0,T,s.get("cid"),s.get("name"),s.getAll("creator"),s.getAll("tag"),s.get("type"),s.get("minter"));for(let e of t){a++;let t=e.token?e.token:e,s=await k(t);n.append(s)}let o=document.getElementById("dMoreTokens");a<20?o.classList.add("is-hidden"):o.classList.remove("is-hidden"),document.getElementById("btnMoreTokens").classList.remove("is-loading"),0===(T+=a)&&(n.textContent="There are no tokens yet.")}async function k(e){let t,n=new URL(window.location);const a=document.getElementById("t-token").content.cloneNode(!0);let s=a.querySelector(".js-price");new Promise((t=>{setTimeout((()=>{t(Promise.all([g(e.contract.address,e.tokenId),s]))}),100)})).then((e=>{e[0]&&(e[1].innerText=(parseFloat(e[0].value.price)/1e6).toFixed(2),e[1].parentNode.classList.remove("is-hidden"))}));let i=e.metadata?.name;t=a.querySelector(".js-name"),t.innerText=i||"";let r=a.querySelector(".js-creators"),c=a.querySelector(".js-creator");i=e.metadata?.creators;try{i=JSON.parse(i);for(let e=0;e<i.length;e++)t=c.cloneNode(!0),t.setAttribute("href",n.origin+n.pathname+"?cmd=tokens&creator="+i[e]),t.append(document.createTextNode(o(i[e]))),e>0&&r.append(document.createTextNode(", ")),t.classList.remove("is-hidden"),r.append(t)}catch(e){a.querySelector(".js-creators").innerText=""}if(i=e.totalSupply,t=a.querySelector(".js-count"),t.innerText=i||"",i=e.metadata?.artifactUri,i){try{new URL(i),i=i.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}let n=e.metadata?.mimeType;n&&n.startsWith("video")?(a.querySelector(".js-img").remove(),a.querySelector(".js-audio").remove(),a.querySelector(".js-svg").remove(),t=a.querySelector(".js-video"),t.setAttribute("src",i)):n&&n.startsWith("audio")?(a.querySelector(".js-img").remove(),a.querySelector(".js-video").remove(),a.querySelector(".js-svg").remove(),t=a.querySelector(".js-audio"),t.setAttribute("src",i)):n&&n.startsWith("image/svg+xml")?(a.querySelector(".js-img").remove(),a.querySelector(".js-video").remove(),a.querySelector(".js-audio").remove(),t=a.querySelector(".js-svg"),t.setAttribute("data",i)):(a.querySelector(".js-video").remove(),a.querySelector(".js-audio").remove(),a.querySelector(".js-svg").remove(),t=a.querySelector(".js-img"),t.setAttribute("src",i)),t.classList.remove("is-hidden")}return a.querySelectorAll(".js-token-item").forEach((function(t){t.setAttribute("href",n.origin+n.pathname+"?cmd=token&cid="+e.contract.address+"&tid="+e.tokenId)})),a}async function I(){let n=document.getElementById("dListings"),a=new URLSearchParams(window.location.search),s=a.get("seller"),o=a.get("minprice"),i=a.get("maxprice"),r=a.get("cid"),l=a.get("tid");document.getElementById("btnMoreListings").classList.add("is-loading");let d=0,m=await async function(n,a,s,o,i,r,l){let d="sort.desc=id&active=true&select=key,value&limit=15"+(l?"&offset="+l:"")+(n?"&value.seller="+n:"")+(a?"&value.price.ge="+a:"")+(s?"&value.price.le="+s:"")+(o?"&value.token.address="+o:"")+(i?"&value.token.id="+i:"");try{let n=await fetch("https://api."+e+".tzkt.io/v1/contracts/"+t+"/bigmaps/offers/keys?"+d);if(n.ok)return await n.json();console.log("ERROR "+c()+"(): can't get offers")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}(s,o,i,r,l,0,T);for(let e of m){d++;let t=await L(e);n.append(t)}let u=document.getElementById("dMoreListings");d<15?u.classList.add("is-hidden"):u.classList.remove("is-hidden"),document.getElementById("btnMoreListings").classList.remove("is-loading"),0===(T+=d)&&(n.textContent="There are no listings matching these criteria.")}async function L(e){let n,a=new URL(window.location);const s=document.getElementById("t-listing").content.cloneNode(!0);let i=(await y(e.value.token.address,e.value.token.id)).token,r=i.metadata?.name;n=s.querySelector(".js-name"),n.innerText=r||"";let m=s.querySelector(".js-creators"),u=s.querySelector(".js-creator");r=i.metadata?.creators;try{r=JSON.parse(r);for(let e=0;e<r.length;e++)n=u.cloneNode(!0),n.setAttribute("href",a.origin+a.pathname+"?cmd=tokens&creator="+r[e]),n.append(document.createTextNode(o(r[e]))),e>0&&m.append(document.createTextNode(", ")),n.classList.remove("is-hidden"),m.append(n)}catch(e){s.querySelector(".js-creators").innerText=""}if(r=new Date(Date.parse(e.value.time_start)).toLocaleString(),n=s.querySelector(".js-start-time"),n.innerText=r||"",r=e.value.time_expiry?new Date(Date.parse(e.value.time_expiry))?.toLocaleString():"...",n=s.querySelector(".js-expiry-time"),n.innerText=r||"",r=e.value.amount,n=s.querySelector(".js-amount"),n.innerText=r||"",r=(parseFloat(e.value.price)/1e6).toFixed(2),n=s.querySelector(".js-price"),n.innerText=r||"",r=i.metadata?.artifactUri,r){try{new URL(r),r=r.replace("ipfs://","https://ipfs.io/ipfs/")}catch(e){}let e=i.metadata?.mimeType;e&&e.startsWith("video")?(s.querySelector(".js-img").remove(),s.querySelector(".js-audio").remove(),s.querySelector(".js-svg").remove(),n=s.querySelector(".js-video"),n.setAttribute("src",r)):e&&e.startsWith("audio")?(s.querySelector(".js-img").remove(),s.querySelector(".js-video").remove(),s.querySelector(".js-svg").remove(),n=s.querySelector(".js-audio"),n.setAttribute("src",r)):e&&e.startsWith("image/svg+xml")?(s.querySelector(".js-img").remove(),s.querySelector(".js-video").remove(),s.querySelector(".js-audio").remove(),n=s.querySelector(".js-svg"),n.setAttribute("data",r)):(s.querySelector(".js-video").remove(),s.querySelector(".js-audio").remove(),s.querySelector(".js-svg").remove(),n=s.querySelector(".js-img"),n.setAttribute("src",r)),n.classList.remove("is-hidden")}let g=s.querySelector(".js-btn-buy"),f=s.querySelector(".js-btn-cancel-offer");return e.value.seller===l?(g.classList.add("is-hidden"),f.classList.remove("is-hidden"),f.addEventListener("click",(()=>async function(e){let n=event.currentTarget;n.classList.add("is-loading");let a=event.target.closest(".js-listing"),s=await async function(e){try{let n=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"cancel_offer",value:JSON.parse('{ "int": "'+e+'" }')}}]});if(n.transactionHash)return n.transactionHash}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}}(e);s&&(q(s),a.remove()),n.classList.remove("is-loading")}(e.key)))):(f.classList.add("is-hidden"),g.classList.remove("is-hidden"),g.addEventListener("click",(()=>S(e.key,e.value.price)))),s.querySelectorAll(".js-token-item").forEach((function(e){e.setAttribute("href",a.origin+a.pathname+"?cmd=token&cid="+i.contract.address+"&tid="+i.tokenId)})),s}document.getElementById("btnMoreListings").addEventListener("click",(()=>I())),document.getElementById("btnSearch").addEventListener("click",(()=>async function(){let e="";if(document.getElementById("searchListTab").classList.contains("is-active")){let t,n,a=document.getElementById("searchListMinPrice").value;if(a){if(a=Math.round(parseFloat(a)*10**6),Number.isNaN(a)||a<=0)return void bulmaToast.toast({message:"Invalid min price.",type:"is-danger"});t=a,e+="&minprice="+a}if(a=document.getElementById("searchListMaxPrice").value,a){if(a=Math.round(parseFloat(a)*10**6),Number.isNaN(a)||a<=0)return void bulmaToast.toast({message:"Invalid max price.",type:"is-danger"});n=a,e+="&maxprice="+a}if(t&&n&&t>n)return void bulmaToast.toast({message:"Invalid price range.",type:"is-danger"});if(a=document.getElementById("searchListAddress").value.trim(),a){if(!r(a))return void bulmaToast.toast({message:"Invalid token or collection address.",type:"is-danger"});e+="&cid="+a}if(a=document.getElementById("searchListSeller").value.trim(),a){if(!r(a))return void bulmaToast.toast({message:"Invalid seller address.",type:"is-danger"});e+="&seller="+a}window.location.search="cmd=listings"+e}else if(document.getElementById("searchColTab").classList.contains("is-active")){let t=document.getElementById("searchColCreator").value.trim();if(t){if(!r(t))return void bulmaToast.toast({message:"Invalid creator address.",type:"is-danger"});e+="&creator="+t}window.location.search="cmd=collections"+e}else if(document.getElementById("searchTokTab").classList.contains("is-active")){let t=document.getElementById("searchTokName").value.trim();if(t){if(t.length>200)return void bulmaToast.toast({message:"The name length must be less than 200 characters.",type:"is-danger"});e+="&name="+t}t=document.getElementById("searchTokCreators").value.trim().split(/\s*,\s*/).filter((e=>e.length>0));for(let n of t){if(!r(n))return void bulmaToast.toast({message:"Invalid creator address: "+n,type:"is-danger"});e+="&creator="+n.trim()}t=document.getElementById("searchTokTags").value.trim().split(/\s*,\s*/).filter((e=>e.length>0));for(let n of t){if(n.length<3)return void bulmaToast.toast({message:"The tag length must be more than 2 characters.",type:"is-danger"});e+="&tag="+n.trim()}if(t=document.getElementById("searchTokType").value.trim(),t&&(e+="&type="+t),t=document.getElementById("searchTokMinter").value.trim(),t){if(!r(t))return void bulmaToast.toast({message:"Invalid minter address.",type:"is-danger"});e+="&minter="+t}window.location.search="cmd=tokens"+e}}())),document.getElementById("btnNewCollectionCreate").addEventListener("click",(()=>async function(){let e,t=new Map;if(e=document.getElementById("cName").value.trim(),!e)return void bulmaToast.toast({message:"The collection name must not be empty.",type:"is-danger"});if(e.length>200)return void bulmaToast.toast({message:"The name length must be less than 200 characters.",type:"is-danger"});if(t.set("name",e),e=document.getElementById("cDescription").value.trim(),e){if(e.length>2e3)return void bulmaToast.toast({message:"The description length must be less than 2000 characters.",type:"is-danger"});t.set("description",e)}if(e=document.getElementById("cSymbol").value.trim(),e&&t.set("symbol",e),e=document.getElementById("cType").value.trim(),e&&t.set("type",e),e=document.getElementById("cInterfaces").value.split(/\s*,\s*/).filter((e=>e.length>0)),e.length>0&&t.set("interfaces",e),e=document.getElementById("cAuthors").value.split(/\s*,\s*/).filter((e=>e.length>0)),e.length>0&&t.set("authors",e),e=document.getElementById("cAddresses").value.split(/\s*,\s*/).filter((e=>e.length>0)),e.length>0){for(let t of e)if(!r(t))return void bulmaToast.toast({message:"Invalid author address: "+t,type:"is-danger"});e.sort(),t.set("authoraddress",e)}if(e=document.getElementById("cCreators").value.split(/\s*,\s*/).filter((e=>e.length>0)),e.length>0){for(let t of e)if(!r(t))return void bulmaToast.toast({message:"Invalid creator address: "+t,type:"is-danger"});e.sort(),t.set("creators",e)}const n=document.getElementById("cFile").files;n.length>0&&(e=await new Promise((e=>{let t=new FileReader;t.onload=n=>e(t.result),t.readAsDataURL(n[0])})),t.set("imageUri",e)),document.getElementById("btnNewCollectionCreate").classList.add("is-loading");let s=await async function(e){let t=e.size>0?a(JSON.stringify(Object.fromEntries(e))):"";try{let e=await fetch("./user_collection.json");if(e.ok){let n=await e.text();n&&(n=n.replaceAll("${user_address}",l),n=n.replaceAll("${metadata_content}",t));const a=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.ORIGINATION,balance:"0",script:JSON.parse(n)}]});if(a.transactionHash)return a.transactionHash}else console.log("ERROR "+c()+"(): can't create collection")}catch(e){console.log("ERROR "+c()+"(): "+e+JSON.stringify(e))}}(t);s&&q(s),document.getElementById("btnNewCollectionCreate").classList.remove("is-loading")}())),document.getElementById("cFile").addEventListener("change",(()=>function(){const e=document.getElementById("cFile"),t=document.getElementById("cFileImage"),n=document.getElementById("cFileSizeIcon");if(n.classList.add("is-hidden"),e.files.length>0){let a=e.files[0];document.getElementById("cFileName").innerHTML=a.name;let s="0 Bytes";if(a.size>0){let e=["Bytes","KB","MB","GB","TB"],t=Math.floor(Math.log(a.size)/Math.log(1024));s=parseFloat((a.size/Math.pow(1024,t)).toFixed(2))+" "+e[t],a.size>10240&&(n.classList.remove("is-hidden"),n.classList.remove("has-text-danger"),n.classList.add("has-text-warning"),a.size>15360?(n.classList.remove("has-text-warning"),n.classList.add("has-text-danger"),bulmaToast.toast({message:"This file is big. Try to make it smaller.",type:"is-danger"})):bulmaToast.toast({message:"Likely this file is big. Try to make it smaller.",type:"is-warning"}))}document.getElementById("cFileSize").innerHTML=s;let o=new FileReader;o.readAsDataURL(a),o.onload=e=>{t.setAttribute("src",e.target.result)}}else document.getElementById("cFileSize").innerHTML="&nbsp;",document.getElementById("cFileName").innerHTML="Choose a file ...",t.setAttribute("src","")}())),document.getElementById("cFileRemove").addEventListener("click",(()=>(document.getElementById("cFile").value="",document.getElementById("cFileSizeIcon").classList.add("is-hidden"),document.getElementById("cFileSize").innerHTML="&nbsp;",document.getElementById("cFileName").innerHTML="Choose a file ...",void document.getElementById("cFileImage").setAttribute("src","")))),document.getElementById("btnNewTokenCreate").addEventListener("click",(()=>async function(){let t,n=new Map,s=document.getElementById("nftCollection").value;if(!s)return void bulmaToast.toast({message:"Collection must be selected.",type:"is-danger"});if(t=document.getElementById("nftName").value.trim(),t){if(t.length>200)return void bulmaToast.toast({message:"The name length must be less than 200 characters.",type:"is-danger"});n.set("name",t)}if(t=document.getElementById("nftDescription").value.trim(),t){if(t.length>200)return void bulmaToast.toast({message:"The description length must be less than 2000 characters.",type:"is-danger"});n.set("description",t)}if(t=document.getElementById("nftTags").value.trim().split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0){for(let e of t)if(e.length<3)return void bulmaToast.toast({message:"The tag length must be more than 2 characters.",type:"is-danger"});t.sort(((e,t)=>e.localeCompare(t))),n.set("tags",t)}if(t=document.getElementById("nftCreators").value.trim().split(/\s*,\s*/).filter((e=>e.length>0)),t.length>0){for(let e of t)if(!r(e))return void bulmaToast.toast({message:"Invalid creator address: "+e,type:"is-danger"});t.sort(),n.set("creators",t)}t=document.getElementById("nftType").value.trim(),t&&n.set("mimeType",t),t=document.getElementById("nftRights").value.trim(),t&&n.set("rights",t),t=document.getElementById("nftDecimals").value.trim(),t&&n.set("decimals",t);let o=new Map,i=0,m=document.getElementById("pageNewToken").querySelectorAll(".js-royalties-line-data");for(let e of m){let t=e.querySelector(".js-royalties-data-address").value.trim();if(0===t.length)return void bulmaToast.toast({message:"The royalty address must not be empty.",type:"is-danger"});if(!r(t))return void bulmaToast.toast({message:"Invalid royalty address: "+t,type:"is-danger"});if(o.has(t))return void bulmaToast.toast({message:"The royalty addresses must be different.",type:"is-danger"});let n=e.querySelector(".js-royalties-data-value").value;try{n=Math.round(100*parseFloat(n))}catch(e){return void bulmaToast.toast({message:"The royalty value must be a number.",type:"is-danger"})}if(n<=0)return void bulmaToast.toast({message:"The royalty value must be greater than zero.",type:"is-danger"});if(i+=n,i>2500)return void bulmaToast.toast({message:"The maximum amount of the total royalty shall not exceed 25%.",type:"is-danger"});o.set(t,n)}o.size>0&&(t='{"decimals":4,"shares":'+JSON.stringify(Object.fromEntries(o))+"}",n.set("royalties",t));const u=document.getElementById("nftFile").files;if(!(u.length>0))return void bulmaToast.toast({message:"Media file must be selected.",type:"is-danger"});t=await new Promise((e=>{let t=new FileReader;t.onload=n=>e(t.result),t.readAsDataURL(u[0])})),n.set("artifactUri",t);let g=new Map,y=document.getElementById("pageNewToken").querySelectorAll(".js-attributes-line-data");for(let e of y){let t=e.querySelector(".js-attributes-data-name").value.trim();if(0===t.length)return void bulmaToast.toast({message:"The attribute name must not be empty.",type:"is-danger"});if(g.has(t))return void bulmaToast.toast({message:"The attribute names must be different.",type:"is-danger"});let n=e.querySelector(".js-attributes-data-value").value;g.set(t,n)}if(g.size>0){let e="[",t=!0;for(let[n,a]of g)t?t=!1:e+=",",e+='{"name":"'+n+'","value":"'+a+'"}';e+="]",n.set("attributes",e)}let f=document.getElementById("nftEditions").value;document.getElementById("btnNewTokenCreate").classList.add("is-loading");let p=await async function(t,n,s){let o="";if((s=new Map([...s].sort())).size>0){let e=!0;for(let[t,n]of s)e?e=!1:o+=",",o+='{"prim":"Elt","args":[{"string":"'+t+'"},{"bytes":"'+a("string"==typeof n||n instanceof String?n:JSON.stringify(n))+'"}]}'}let i='{"string":"'+l+'"}',r='{"int":"'+n+'"}',m="["+o+"]",u=[];try{let n='{"prim":"Pair","args":[${0},{"prim":"Pair","args":[${1},${2}]}]}';try{let a=await fetch("https://api."+e+".tzkt.io/v1/contracts/"+t+"/entrypoints/mint"),s=await a.json();2===Object.keys(s.jsonParameters["schema:object"]).length&&(n='{"prim":"Pair","args":[${0},${1}]}');for(let e of Object.keys(s.jsonParameters["schema:object"]))e.endsWith(":address")?u.push(i):e.endsWith(":nat")?u.push(r):e.endsWith(":map_flat:string:bytes")&&u.push(m)}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}for(let e=0;e<u.length;e++)n=n.replace("${"+e+"}",u[e]);let a=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"mint",value:JSON.parse(n)}}]});if(a.transactionHash)return a.transactionHash}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}}(s,f,n);p&&q(p),document.getElementById("btnNewTokenCreate").classList.remove("is-loading")}())),document.getElementById("nftFile").addEventListener("change",(()=>function(){const e=document.getElementById("nftFile"),t=document.getElementById("nftFileImage"),n=document.getElementById("nftType"),a=document.getElementById("nftFileSizeIcon");if(a.classList.add("is-hidden"),e.files.length>0){let s=e.files[0];document.getElementById("nftFileName").innerHTML=s.name,n.value=s.type;let o="0 Bytes";if(s.size>0){let e=["Bytes","KB","MB","GB","TB"],t=Math.floor(Math.log(s.size)/Math.log(1024));o=parseFloat((s.size/Math.pow(1024,t)).toFixed(2))+" "+e[t],s.size>20480&&(a.classList.remove("is-hidden"),a.classList.remove("has-text-danger"),a.classList.add("has-text-warning"),s.size>28672?(a.classList.remove("has-text-warning"),a.classList.add("has-text-danger"),bulmaToast.toast({message:"This file is big. Try to make it smaller.",type:"is-danger"})):bulmaToast.toast({message:"Likely this file is big. Try to make it smaller.",type:"is-warning"}))}document.getElementById("nftFileSize").innerHTML=o;let i=new FileReader;i.onload=e=>{t.setAttribute("src",e.target.result)},i.readAsDataURL(s)}else n.value="",document.getElementById("nftFileSize").innerHTML="&nbsp;",document.getElementById("nftFileName").innerHTML="Choose a file ...",t.setAttribute("src","")}())),document.getElementById("nftFileRemove").addEventListener("click",(()=>(document.getElementById("nftFile").value="",document.getElementById("nftType").value="",document.getElementById("nftFileSizeIcon").classList.add("is-hidden"),document.getElementById("nftFileSize").innerHTML="&nbsp;",document.getElementById("nftFileName").innerHTML="Choose a file ...",void document.getElementById("nftFileImage").setAttribute("src","")))),document.getElementById("btnTokenList").addEventListener("click",(()=>async function(){w&&document.getElementById("mListTokenAmount").setAttribute("max",w.balance),document.getElementById("mListToken").classList.add("is-active")}())),document.getElementById("btnListTokenList").addEventListener("click",(()=>async function(){if(!w)return void bulmaToast.toast({message:"The token is not found.",type:"is-danger"});let e=Math.round(parseFloat(document.getElementById("mListTokenPrice").value)*10**6);if(Number.isNaN(e)||e<=0)return void bulmaToast.toast({message:"Invalid price.",type:"is-danger"});let n,a=w.token.contract.address,s=w.token.tokenId,o=document.getElementById("mListTokenAmount").value;try{let e=JSON.parse(w.token.metadata.royalties);n=new Map(Object.entries(e.shares));let t=e.decimals;for(let[e,a]of n)n.set(e,Math.trunc(Number(a)/10**t*1e4))}catch(e){n=new Map}let i=document.getElementById("mListTokenStartTiime").value;i=Math.trunc(Date.parse(i)/1e3),i||(i=Math.trunc(Date.now()/1e3));document.getElementById("btnListTokenList").classList.add("is-loading");let r=await async function(e,n,a,s,o,i,r){let m="";if(o&&o.size>0){o=new Map([...o].sort());let e=0;for(let[t,n]of o)e>0&&(m+=","),e++,m+='{"prim":"Elt","args":[{"string":"'+t+'"},{"int":"'+n+'"}]}'}r=r?'"prim":"Some","args":[{"int":"'+r+'"}]':'"prim":"None"';try{let o=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:n,parameters:{entrypoint:"update_operators",value:JSON.parse('[ { "prim": "Left", "args": [ { "prim": "Pair", "args": [ { "string": "'+l+'" }, { "prim": "Pair", "args": [ { "string": "'+t+'" }, { "int": "'+a+'" } ] } ] } ] } ]')}},{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"add_offer",value:JSON.parse('{"prim":"Pair","args":[{"prim":"Pair","args":[{"int":"'+s+'"},{"prim":"Pair","args":[{"int":"'+e+'"},['+m+']]}]},{"prim":"Pair","args":[{'+r+'},{"prim":"Pair","args":[{"int":"'+i+'"},{"prim":"Pair","args":[{"string":"'+n+'"},{"int":"'+a+'"}]}]}]}]}')}}]});if(o.transactionHash)return o.transactionHash}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}}(e,a,s,o,n,i,"");r&&(q(r),document.getElementById("mListToken").classList.remove("is-active")),document.getElementById("btnListTokenList").classList.remove("is-loading")}())),document.getElementById("btnTokenBurn").addEventListener("click",(()=>async function(){w&&document.getElementById("mBurnTokenAmount").setAttribute("max",w.balance),document.getElementById("mBurnToken").classList.add("is-active")}())),document.getElementById("btnBurnTokenBurn").addEventListener("click",(()=>async function(){document.getElementById("btnBurnTokenBurn").classList.add("is-loading");let t=document.getElementById("mBurnTokenAmount").value,n=await async function(t,n,a){try{let s='{"prim":"Pair","args":[{"int":"'+a+'"},{"int":"'+n+'"}]}';try{let a=await fetch("https://api."+e+".tzkt.io/v1/contracts/"+t+"/entrypoints/burn?json=false&michelson=true");(await a.json()).michelsonParameters.startsWith("pair")||(s='{"int":"'+n+'"}')}catch(e){}let o=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:t,parameters:{entrypoint:"burn",value:JSON.parse(s)}}]});if(o.transactionHash)return o.transactionHash}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}}(E,B,t);n&&(q(n),window.history.back()),document.getElementById("btnBurnTokenBurn").classList.remove("is-loading")}())),document.getElementById("btnTokenTransfer").addEventListener("click",(()=>async function(){w&&document.getElementById("mTransferTokenAmount").setAttribute("max",w.balance),document.getElementById("mTransferTokenAddressTo").value="",document.getElementById("mTransferToken").classList.add("is-active")}())),document.getElementById("btnTransferTokenTransfer").addEventListener("click",(()=>async function(){let e=document.getElementById("mTransferTokenAmount").value,t=document.getElementById("mTransferTokenAddressTo").value.trim();if(!r(t))return void bulmaToast.toast({message:"Invalid destination address.",type:"is-danger"});document.getElementById("btnTransferTokenTransfer").classList.add("is-loading");let n=await async function(e,t,n,a){try{let s=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:0,destination:e,parameters:{entrypoint:"transfer",value:JSON.parse('[{"prim": "Pair","args":[{"string":"'+l+'"},[{"prim": "Pair","args":[{"string":"'+a+'"},{"prim": "Pair","args":[{"int":"'+t+'"},{"int":"'+n+'"}]}]}]]}]')}}]});if(s.transactionHash)return s.transactionHash}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}}(E,B,e,t);n&&(q(n),document.getElementById("mTransferToken").classList.remove("is-active")),document.getElementById("btnTransferTokenTransfer").classList.remove("is-loading")}()));var w,B="";async function S(e,n){let a=event.currentTarget;a.classList.add("is-loading");let s=await async function(e,n,a){try{let n=await d.requestOperation({operationDetails:[{kind:beacon.TezosOperationType.TRANSACTION,amount:1*a,destination:t,parameters:{entrypoint:"accept_offer",value:JSON.parse('{"prim":"Pair","args":[{"int":"1"},{"int":"'+e+'"}]}')}}]});if(n.transactionHash)return n.transactionHash}catch(e){console.log("ERROR "+c()+"(): "+e+" "+JSON.stringify(e))}}(e,0,n);s&&q(s),a.classList.remove("is-loading")}function R(){let e=event.currentTarget.querySelector(".fas");event.currentTarget.parentElement.querySelector(".is-collapsible").classList.toggle("is-active"),e.classList.toggle("fa-angle-down"),e.classList.toggle("fa-angle-up")}async function j(t){let n=l;await async function(t){let n=await d.getActiveAccount();if(n)l=n.address;else if(!t){let t=await d.requestPermissions({network:{type:e}});l=t.address}}(t),l&&(document.getElementById("divConnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML=o(l),document.getElementById("divDisconnect").classList.remove("is-hidden")),t||n===l||window.location.reload()}function N(){document.querySelectorAll(".js-page").forEach((function(e){e.classList.add("is-hidden")}))}function q(t){bulmaToast.toast({message:"Your request is processing with ID <a href='https://"+e+".tzkt.io/"+t+"' target='_blank'>"+o(t)+"</a>",duration:5e3,type:"is-success"})}document.querySelectorAll(".js-faq-item").forEach((function(e){e.onclick=R})),document.getElementById("btnConnect").addEventListener("click",(()=>j(!1))),document.getElementById("btnDisconnect").addEventListener("click",(()=>async function(){await async function(){await d.clearActiveAccount(),l=""}(),l||(document.getElementById("divDisconnect").classList.add("is-hidden"),document.getElementById("aAddress").innerHTML="",document.getElementById("divConnect").classList.remove("is-hidden")),window.location.reload()}())),document.getElementById("btnMenuTokens").addEventListener("click",(()=>{window.location.search="cmd=tokens"})),document.getElementById("btnMenuCollections").addEventListener("click",(()=>{window.location.search="cmd=collections"})),document.getElementById("btnMenuListings").addEventListener("click",(()=>{window.location.search="cmd=listings"})),document.getElementById("btnMenuSearch").addEventListener("click",(()=>{window.location.search="cmd=search"})),document.getElementById("btnMenuNewToken").addEventListener("click",(()=>{window.location.search="cmd=newtoken"})),document.getElementById("btnMenuNewCollection").addEventListener("click",(()=>{window.location.search="cmd=newcollection"})),document.getElementById("btnMenuInfo").addEventListener("click",(()=>{window.location.search="cmd=info"})),document.getElementById("btnMenuCopyAddress").addEventListener("click",(()=>{l&&i(l)&&bulmaToast.toast(f)})),document.getElementById("btnMenuMyCollections").addEventListener("click",(()=>{window.location.search="cmd=collections&creator="+l})),document.getElementById("btnMenuMyTokens").addEventListener("click",(()=>{window.location.search="cmd=tokens&account="+l})),document.getElementById("btnMenuMyListings").addEventListener("click",(()=>{window.location.search="cmd=listings&seller="+l})),LT={}})();